// Lưu bitmap vào bộ nhớ external
    private fun saveBitmapToExternalStorage(bitmap: Bitmap) {
        val resolver = contentResolver
        val imageCollection = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            MediaStore.Images.Media.getContentUri(MediaStore.VOLUME_EXTERNAL_PRIMARY)
        } else {
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI
        }

        val contentValues = ContentValues().apply {
            put(MediaStore.Images.Media.DISPLAY_NAME, "image_${System.currentTimeMillis()}.png")
            put(MediaStore.Images.Media.MIME_TYPE, "image/png")
            put(MediaStore.Images.Media.RELATIVE_PATH, "Pictures/AR") // For Android 10+ (Scoped Storage)
        }

        val imageUri = resolver.insert(imageCollection, contentValues)
        if (imageUri != null) {
            try {
                val outputStream: OutputStream? = resolver.openOutputStream(imageUri)
                if (outputStream != null) {
                    bitmap.compress(Bitmap.CompressFormat.PNG, 100, outputStream)
                }
                outputStream?.close()

                // Update fileMedia
                fileMedia = imageUri.toString()

                // Notify the user
                Toast.makeText(this, "Success ${imageUri.path}", Toast.LENGTH_LONG).show()
            } catch (e: Exception) {
                e.printStackTrace()
                Toast.makeText(this, "Failed to save image", Toast.LENGTH_SHORT).show()
            }
        } else {
            Toast.makeText(this, "Failed to create image Uri", Toast.LENGTH_SHORT).show()
        }
    }